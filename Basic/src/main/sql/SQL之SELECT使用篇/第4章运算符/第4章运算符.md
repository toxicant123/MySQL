# 第4章 运算符

## 1. 算术运算符

算术运算符主要用于数学运算，其可以连接运算符前后的两个数值或表达式，对数值或表达式进行加（+）、减（-）、乘（*）、除（/）和取模（%）运算。

|  运算符   |    名称     |      作用      |                    示例                    |
|:------:|:---------:|:------------:|:----------------------------------------:|
|   +    |   加法运算符   | 计算两个值或表达式的和  |               SELECT A + B               |
|   -    |   减法运算符   | 计算两个值或表达式的差  |               SELECT A - B               |
|   *    |   乘法运算符   | 计算两个值或表达式的乘积 |               SELECT A * B               |
| / 或DIV |   除法运算符   | 计算两个值或表达式的商  | SELECT A / B <br/>或者<br/> SELECT A DIV B |
| % 或MOD | 求模（求余）运算符 | 计算两个值或表达式的余数 | SELECT A % B <br/>或者<br/> SELECT A MOD B |


### 1.1 加法与减法运算符
 
```
mysql> SELECT 100, 100 + 0, 100 - 0, 100 + 50, 100 + 50 -30, 100 + 35.5, 100 - 35.5
FROM dual;

+-----+---------+---------+----------+--------------+------------+------------+
| 100 | 100 + 0 | 100 - 0 | 100 + 50 | 100 + 50 -30 | 100 + 35.5 | 100 - 35.5 |
+-----+---------+---------+----------+--------------+------------+------------+
| 100 | 100     | 100     | 150      | 120          | 135.5      | 64.5       |
+-----+---------+---------+----------+--------------+------------+------------+
1 row in set (0.00 sec)
```

由运算结果可以得出如下结论：
* 一个整数类型的值对整数进行加法和减法操作，结果还是一个整数；
* 一个整数类型的值对浮点数进行加法和减法操作，结果是一个浮点数；
* 加法和减法的优先级相同，进行先加后减操作与进行先减后加操作的结果是一样的；
* 在Java中，+的左右两边如果有字符串，那么表示字符串的拼接。但是在MySQL中+只表示数值相加。如果遇到非数值类型，先尝试转成数值，如果转失败，就按0计算。（补充：MySQL中字符串拼接要使用字符串函数CONCAT()实现）

```
# 在SQL中，'+'没有连接的作用，就表示加法运算。此时，会将字符串转换为数值（隐式转换）
# 在Java语言中，结果是：1001。
SELECT 100 + '1'  
FROM DUAL;

# 此时将'a'看做0处理
SELECT 100 + 'a' 
FROM DUAL;

# null值参与运算，结果为null
SELECT 100 + NULL 
FROM DUAL;
```

### 1.2 乘法与除法运算符

```
mysql> SELECT 100, 100 * 1, 100 * 1.0, 100 / 1.0, 100 / 2,100 + 2 * 5 / 2,100 /3, 100 DIV 0 FROM dual;
+-----+---------+-----------+-----------+---------+-----------------+---------+-----------+
| 100 | 100 * 1 | 100 * 1.0 | 100 / 1.0 | 100 / 2 | 100 + 2 * 5 / 2 | 100 /3  | 100 DIV 0 |
+-----+---------+-----------+-----------+---------+-----------------+---------+-----------+
| 100 | 100     | 100.0     | 100.0000  | 50.0000 | 105.0000        | 33.3333 | NULL      |
+-----+---------+-----------+-----------+---------+-----------------+---------+-----------+
1 row in set (0.00 sec)
```

```
#计算出员工的年基本工资
SELECT employee_id,salary,salary * 12 annual_sal
FROM employees;
```

由运算结果可以得出如下结论：
* 一个数乘以整数1和除以整数1后仍得原数；
* 一个数乘以浮点数1和除以浮点数1后变成浮点数，数值与原数相等；
* 一个数除以整数后，不管是否能除尽，结果都为一个浮点数；
* 一个数除以另一个数，除不尽时，结果为一个浮点数，并保留到小数点后4位；
* 乘法和除法的优先级相同，进行先乘后除操作与先除后乘操作，得出的结果相同。
* 在数学运算中，0不能用作除数，在MySQL中，一个数除以0为NULL。

### 1.3. 求模（求余）运算符

```
mysql> SELECT 12 % 3, 12 MOD 5 FROM dual;
+--------+----------+
| 12 % 3 | 12 MOD 5 |
+--------+----------+
| 0      | 2        |
+--------+----------+
1 row in set (0.00 sec)
```

```
#筛选出employee_id是偶数的员工
SELECT * 
FROM employees
WHERE employee_id MOD 2 = 0;
```

`%`与`MOD`均可表示求模运算

## 2. 比较运算符

比较运算符用来对表达式左边的操作数和右边的操作数进行比较，比较的结果为真则返回1，比较的结果为假则返回0，其他情况则返回NULL。

比较运算符经常被用来作为SELECT查询语句的条件来使用，返回符合条件的结果记录。

|  运算符   |   名称    |                作用                |                                   示例                                    |
|:------:|:-------:|:--------------------------------:|:-----------------------------------------------------------------------:|
|   =    |  等于运算符  |        判断两个值、字符串或表达式是否相等         |                     SELECT C FROM TABLE WHERE A = B                     |
|  <=>   | 安全等于运算符 |       安全地判断两个值、字符串或表达式是否相等       |                    SELECT C FROM TABLE WHERE A <=> B                    |
| <>(!=) | 不等于运算符  |        判断两个值、字符串或表达式是否不相等        | SELECT C FROM TABLE WHERE A <> B <br/> SELECT C FROM TABLE WHERE A != B |
|   <    |  小于运算符  |  判断前面的值、字符串或表达式是否小于后面的值、字符串或表达式  |                     SELECT C FROM TABLE WHERE A < B                     |
|   <=   | 小于等于运算符 | 判断前面的值、字符串或表达式是否小于等于后面的值、字符串或表达式 |                    SELECT C FROM TABLE WHERE A <= B                     |
|   \>   |  大于运算符  |  判断前面的值、字符串或表达式是否大于后面的值、字符串或表达式  |                     SELECT C FROM TABLE WHERE A > B                     |
|  \>=   | 大于等于运算符 | 判断前面的值、字符串或表达式是否大于等于后面的值、字符串或表达式 |                    SELECT C FROM TABLE WHERE A >= B                     |

此外，还有非符号类型的运算符：

|     运算符     |    名称    |          作用          |                     示例                      |
|:-----------:|:--------:|:--------------------:|:-------------------------------------------:|
|   IS NULL   |  为空运算符   |   判断值、字符串或表达式是否为空    |     SELECT B FROM TABLE WHERE A IS NULL     |
| IS NOT NULL |  不为空运算符  |   判断值、字符串或表达式是否为不空   |   SELECT B FROM TABLE WHERE A IS NOT NULL   |
|    LEAST    |  最小值运算符  |      在多个值中返回最小值      |   SELECT D FROM TABLE WHERE C LEAST(A,B)    |
|  GREATEST   |  最大值运算符  |      在多个值中返回最大值      |  SELECT D FROM TABLE WHERE C GREATEST(A,B)  |
| BETWEEN AND | 两值之间运算符  |    判断一个值是否在两个值之间     | SELECT D FROM TABLE WHERE C BETWEEN A AND B |
|   ISNULL    |  为空运算符   |  判断一个值、字符串或表达式是否为空   |     SELECT B FROM TABLE WHERE A ISNULL      |
|     IN      |  属于运算符   |  判断一个值是否为列表中的任意一个值   |    SELECT D FROM TABLE WHERE C IN (A,B)     |
|   NOT IN    |  不属于运算符  | 判断一个值是否不是一个列表中的任意一个值 |  SELECT D FROM TABLE WHERE A NOT IN (A,B)   |
|    LIKE     | 模糊匹配运算符  |   判断一个值是否符合模糊匹配规则    |     SELECT C FROM TABLE WHERE A LIKE B      |
|   REGEXP    | 正则表达式运算符 |  判断一个值是否符合正则表达式的规则   |    SELECT C FROM TABLE WHERE A REGEXP B     |
|    RLIKE    | 正则表达式运算符 |  判断一个值是否符合正则表达式的规则   |     SELECT C FROM TABLE WHERE A RLIKE B     |
 


### 2.1 等号运算符

* 等号运算符（=）判断等号两边的值、字符串或表达式是否相等，如果相等则返回1，不相等则返回0。
* 在使用等号运算符时，遵循如下规则：
  + 如果等号两边的值、字符串或表达式都为字符串，则MySQL会按照字符串进行比较，其比较的是每个字符串中字符的ANSI编码是否相等。
  + 如果等号两边的值都是整数，则MySQL会按照整数来比较两个值的大小。
  + 如果等号两边的值一个是整数，另一个是字符串，则MySQL会将字符串转化为数字进行比较。
  + 如果等号两边的值、字符串或表达式中有一个为NULL，则比较结果为NULL。
* 对比：SQL中赋值符号使用: =

```
# 字符串存在隐式转换。如果转换数值不成功，则看做0
SELECT 1 = 2, 1 != 2, 1 = '1', 1 = 'a', 0 = 'a' 
FROM DUAL;
+-------+--------+---------+---------+---------+
| 1 = 2 | 1 != 2 | 1 = '1' | 1 = 'a' | 0 = 'a' |
+-------+--------+---------+---------+---------+
|     0 |      1 |       1 |       0 |       1 |
+-------+--------+---------+---------+---------+

# 两边都是字符串的话，则按照ANSI的比较规则进行比较。
SELECT 'a' = 'a', 'ab' = 'ab', 'a' = 'b' 
FROM DUAL;
+-----------+-------------+-----------+
| 'a' = 'a' | 'ab' = 'ab' | 'a' = 'b' |
+-----------+-------------+-----------+
|         1 |           1 |         0 |
+-----------+-------------+-----------+

# 只要有null参与判断，结果就为null
SELECT 1 = NULL, NULL = NULL 
FROM DUAL;
+----------+-------------+
| 1 = NULL | NULL = NULL |
+----------+-------------+
|     NULL |        NULL |
+----------+-------------+

#查询salary=10000，注意在Java中比较是==
SELECT employee_id,salary FROM employees WHERE salary = 10000;
+-------------+----------+
| employee_id | salary   |
+-------------+----------+
|         150 | 10000.00 |
|         156 | 10000.00 |
|         169 | 10000.00 |
|         204 | 10000.00 |
+-------------+----------+

#此时执行，不会有任何的结果
SELECT last_name, salary, commission_pct
FROM employees
WHERE commission_pct = NULL;
```

### 2.2 安全等于运算符

安全等于运算符（<=>）与等于运算符（=）的作用是相似的， 唯一的区别是`<=>`可以用来对NULL进行判断。在两个操作数均为NULL时，其返回值为1，而不为NULL；当一个操作数为NULL时，其返回值为0，而不为NULL。

```
# 为null而生
# 不处理与null相关的值时与等于运算符无异
SELECT 1 <=> 2, 1 <=> '1', 1 <=> 'a', 0 <=> 'a'
FROM DUAL;
+---------+-----------+-----------+-----------+
| 1 <=> 2 | 1 <=> '1' | 1 <=> 'a' | 0 <=> 'a' |
+---------+-----------+-----------+-----------+
|       0 |         1 |         0 |         1 |
+---------+-----------+-----------+-----------+

# 处理null值时按上述规则
SELECT 1 <=> NULL, NULL <=> NULL
FROM DUAL;
+------------+---------------+
| 1 <=> NULL | NULL <=> NULL |
+------------+---------------+
|          0 |             1 |
+------------+---------------+

#查询表中commission_pct为null的数据有哪些
SELECT last_name, salary, commission_pct
FROM employees
WHERE commission_pct <=> NULL;
```

可以看到，使用安全等于运算符时，两边的操作数的值都为NULL时，返回的结果为1而不是NULL，其他返回结果与等于运算符相同。

### 2.3 不等于运算符

不等于运算符（<>和!=）用于判断两边的数字、字符串或者表达式的值是否不相等，如果不相等则返回1，相等则返回0。不等于运算符不能判断NULL值。如果两边的值有任意一个为NULL，或两边都为NULL，则结果为NULL。

```
SELECT 3 <> 2, '4' <> NULL, '' != NULL, NULL != NULL
FROM DUAL;
+--------+-------------+------------+--------------+
| 3 <> 2 | '4' <> NULL | '' != NULL | NULL != NULL |
+--------+-------------+------------+--------------+
|      1 |        NULL |       NULL |         NULL |
+--------+-------------+------------+--------------+

SELECT 1 <> 1, 1 != 2, 'a' != 'b', (3+4) <> (2+6), 'a' != NULL, NULL <> NULL;
+--------+--------+------------+----------------+-------------+--------------+
| 1 <> 1 | 1 != 2 | 'a' != 'b' | (3+4) <> (2+6) | 'a' != NULL | NULL <> NULL |
+--------+--------+------------+----------------+-------------+--------------+
|      0 |      1 |          1 |              1 |        NULL |         NULL |
+--------+--------+------------+----------------+-------------+--------------+
```
### 2.4 空运算符



















